<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>YouTube Downloader</title>
  <style>
    body {
      margin: 0;
      font-family: Arial, sans-serif;
      background: linear-gradient(135deg, #6a11cb, #2575fc);
      color: white;
      text-align: center;
      padding: 40px;
    }
    h1 { margin-bottom: 20px; }
    input {
      padding: 12px;
      width: 80%;
      max-width: 400px;
      border-radius: 12px;
      border: none;
      margin-bottom: 15px;
    }
    button {
      padding: 12px 20px;
      border-radius: 12px;
      border: none;
      background: #ff4081;
      color: white;
      font-size: 16px;
      cursor: pointer;
    }
    button:hover { background: #e73370; }

    #spinner {
      display: none;
      margin: 20px auto;
      border: 6px solid rgba(255,255,255,0.3);
      border-top: 6px solid #fff;
      border-radius: 50%;
      width: 40px;
      height: 40px;
      animation: spin 1s linear infinite;
    }
    @keyframes spin { 100% { transform: rotate(360deg); } }
    #results img { max-width: 200px; border-radius: 10px; margin: 10px 0; }
  </style>
</head>
<body>
  <h1>YouTube Downloader</h1>
  <input type="text" id="url" placeholder="Paste YouTube link..." />
  <br>
  <button onclick="fetchInfo()">Get Formats</button>
  <div id="spinner"></div>
  <div id="results"></div>

  <script>
    async function fetchInfo() {
      const url = document.getElementById("url").value;
      if (!url) return;
      document.getElementById("spinner").style.display = "block";
      document.getElementById("results").innerHTML = "";

      try {
        const res = await fetch(`/info?url=${encodeURIComponent(url)}`);
        const data = await res.json();
        document.getElementById("spinner").style.display = "none";

        if (data.error) {
          document.getElementById("results").innerHTML = `<p>Error: ${data.error}</p>`;
          return;
        }

        let html = `<h2>${data.title}</h2>`;
        if (data.thumbnail) html += `<img src="${data.thumbnail}" alt="thumbnail">`;

        html += "<ul>";
        data.formats.forEach(f => {
          html += `<li>${f.ext.toUpperCase()} ${f.resolution} 
            <a href="/download?url=${encodeURIComponent(url)}&format_id=${f.format_id}">
              <button>Download</button>
            </a>
          </li>`;
        });
        html += "</ul>";

        document.getElementById("results").innerHTML = html;
      } catch (err) {
        document.getElementById("spinner").style.display = "none";
        document.getElementById("results").innerHTML = `<p>Error: ${err}</p>`;
      }
    }
  </script>
</body>
</html>